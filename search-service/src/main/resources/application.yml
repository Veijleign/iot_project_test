spring:
  application:
    name: search-service


  kafka:
    bootstrap-servers: 37.233.82.76:9092

    consumer:
      # Consumer Group
      group-id: rule-engine-consumer-group

      # Serializers/Deserializers
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.ByteArrayDeserializer

      # Offset Management
      auto-offset-reset: earliest  # earliest | latest | none
      enable-auto-commit: false    # Manual commit for reliability
      auto-commit-interval: 5000   # commit every 5 ??????

      # Fetch Settings
      fetch-min-size: 1            # min byte for fetch
      fetch-max-wait: 500          # max 500ms for fetch
      max-poll-records: 100

      # Session Management
      max-poll-interval-ms: 300000 # 5 min for batch processing
      session-timeout-ms: 30000    # 30 secs session timeout
      heartbeat-interval-ms: 3000  # 3 secs heartbeat

      properties:
        # Isolation Level (??? transactional producers)
        isolation.level: read_committed

        # Partition Assignment Strategy
        partition.assignment.strategy: org.apache.kafka.clients.consumer.RangeAssignor

        # Connection Settings
        connections.max.idle.ms: 540000
        request.timeout.ms: 30000

        # Retry Settings
        retry.backoff.ms: 100
        reconnect.backoff.ms: 50
        reconnect.backoff.max.ms: 1000

    listener:
      ack-mode: manual
      type: single
      concurrency: 3
      poll-timeout: 3000

  data:
    redis:
      host: 37.233.82.76
      port: 6379
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 2

# Elasticsearch Index Settings
elasticsearch:
  indexes:
    sensors:
      name: iot-sensors
      number-of-shards: 3
      number-of-replicas: 1
    alerts:
      name: iot-alerts
      number-of-shards: 3
      number-of-replicas: 1
    audit-logs:
      name: iot-audit-logs
      number-of-shards: 2
      number-of-replicas: 1

cache:
  enabled: true
  ttl: 300  # seconds
  max-size: 10000

server:
  port: 8084

logging:
  level:
    org.iot_platform.searchservice: DEBUG
    org.apache.lucene: INFO
    org.springframework.kafka: INFO
  file:
    name: logs/search-service.log